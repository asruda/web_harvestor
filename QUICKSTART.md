# 网页数据抓取工具 - 快速开始指南

## 安装步骤

### 1. 安装依赖

双击运行 `install.bat` 脚本，它会自动完成以下操作：
- 检查Python环境
- 安装所需的Python包
- 创建必要的数据目录

或者手动执行：
```bash
pip install -r requirements.txt
```

### 2. 运行程序

双击 `run.bat` 或在命令行中执行：
```bash
python main.py
```

## 使用流程

### 第一步：创建网站配置

1. 点击左侧的 **"➕ 新建网站配置"** 按钮
2. 输入网站名称（如：京东商城）
3. 输入起始URL（如：https://www.jd.com）
4. 系统会自动创建默认的页面配置和抓取策略

### 第二步：配置抓取规则（高级）

默认配置已经可以开始抓取，如需自定义：
- 修改表格选择器（如：`table.data-table`）
- 配置字段映射（列索引到字段名）
- 设置翻页策略（按钮选择器）

### 第三步：开始抓取

1. 在左侧列表中选择已创建的网站配置
2. 等待程序加载配置（右上角显示"当前: XXX"）
3. 点击 **"🎯 开始抓取"** 按钮
4. 查看日志输出和进度条
5. 等待抓取完成

### 第四步：查看结果

抓取完成后，数据会自动导出到 `data/exports/` 目录，支持以下格式：
- **CSV** - 表格数据，可用Excel打开
- **JSON** - 结构化数据，便于程序处理
- **Excel** - xlsx格式，带格式化

## 配置说明

### 表格选择器

使用CSS选择器定位网页中的表格，例如：
- `table` - 选择页面中的第一个表格
- `.data-table` - 选择class为data-table的表格
- `#results table` - 选择ID为results下的表格

### 字段映射

定义表格列与导出字段的对应关系：
```python
{
    0: "商品名称",    # 第1列映射为"商品名称"
    1: "价格",        # 第2列映射为"价格"
    2: "库存",        # 第3列映射为"库存"
    3: "详情链接"     # 第4列映射为"详情链接"
}
```

### 翻页策略

- **按钮点击**: 配置"下一页"按钮的选择器（如：`.next-page`）
- **最大页数**: 限制抓取的最大页数，防止无限抓取

## 注意事项

1. **合法使用**: 仅抓取有权访问的数据，遵守网站服务条款
2. **控制频率**: 避免过快的抓取速度对目标网站造成负担
3. **Cookie安全**: Cookie文件已加密存储在 `data/cookies/` 目录
4. **数据备份**: 定期备份导出的数据文件

## 常见问题

### Q: 浏览器无法启动？
A: 检查PyQt6和PyQt6-WebEngine是否正确安装，可尝试重新安装依赖

### Q: 找不到表格数据？
A: 检查表格选择器是否正确，可以使用浏览器开发者工具查看元素

### Q: 翻页不工作？
A: 确认"下一页"按钮的选择器是否正确

### Q: 数据导出失败？
A: 检查 `data/exports/` 目录是否有写入权限

## 技术支持

如遇到问题，请查看日志输出，或提交Issue到项目仓库。

## 开发计划

当前版本: v0.1.0 (第一阶段)

已完成功能：
- ✅ PyQt6图形界面
- ✅ QWebEngineView浏览器控制
- ✅ BeautifulSoup数据提取
- ✅ Cookie管理和加密存储
- ✅ 简单翻页策略
- ✅ 多格式数据导出（CSV/JSON/Excel）
- ✅ SQLite配置管理

待开发功能：
- ⏳ 可视化元素选择器
- ⏳ 更多翻页策略（URL参数、滚动加载）
- ⏳ 链接跟踪功能
- ⏳ 后台任务管理
- ⏳ 界面美化和用户引导

---

祝您使用愉快！
